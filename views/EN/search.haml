%h2
  #{@region_title}

%p
  %a.all{href: '#'}<
    Show All Certified Refs
%p
  %a.head{href: '#'}<
    Show Only Certified Head Refs

%table#theTable
  %thead
    %tr
      %td
        First Name
      %td
        Last Name
      %td
        Team
      %td
        Email
      %td
        AR
      %td
        SR
      %td
        HR
      - if @reg == 'ALL'
        %td
          Region
      %td
        FT
  %tbody

:javascript
  var refs = #{@refs};
  var odd = false;
  $("#theTable tbody").empty();
  for (var i = 0; i < refs.length; i++) {
    var r = [
      "<tr class=\"",(odd) ? "odd" : "even",refs[i][6],"\">",
      "<td>",refs[i][0],"</td>",
      "<td>",refs[i][1],"</td>",
      "<td>",refs[i][2],"</td>",
      "<td><a href=\"mailto:",refs[i][3],"\">",refs[i][3],"</a></td>",
      "<td>",refs[i][4],"</td>", //ar
      "<td>",refs[i][5],"</td>", //sr
      "<td>",refs[i][6],"</td>", //hr
      ].join(' ');
      if (#{@reg == 'ALL'}) {
        r += ["<td>",refs[i][7],"</td>"].join(' ');
      };

      if (refs[i][9] == "N") {
        if (#{not session[:user].nil? and session[:user]['admin']}) {
          r += [
                "<td>",
                "<div class=\"field_test\"><a href=\"/field/"+refs[i][8]+"?reg=#{@reg}\">",
                "Passed Field Test",
                "</a></div></td>"
              ].join(' ');
        }
        else {
          r += ["<td>",refs[i][9],"</td>"].join(' ');
        }
      }
      else {
        r += ["<td>",refs[i][9],"</td>"].join(' ');
      };

      r += "</tr>";
    odd = !odd;  
    $("#theTable tbody").append(r);
  };

  $('.all').click(function(){
    $('.N').show();
  });
  $('.head').click(function(){
    $('.N').hide();
  // could do something to update colored rows every time (update())
  });

  // $('.field_test').click(function(){
  //   $.get('/
  // });
